(()=>{"use strict";const t=function(){const t=[],e=[];for(let e=0;e<10;e++){t.push([]);for(let n=0;n<10;n++)t[e].push({attacked:!1,ship:!1,ship_index:!1})}return{placeShip:function([n,s,c,a]){const o=[],i=function(t){const e=[...Array(t).fill(!1)];return{hit:t=>0<=t&&t<e.length&&(e[t]=!0,!0),isSunk:()=>!e.includes(!1),length:()=>e.length}}(a);for(let t=0;t<a;t++)switch(c){case 0:o.push([n,s+t]);break;case 90:o.push([n-t,s]);break;case 180:o.push([n,s-t]);break;case 270:o.push([n+t,s])}let r=!0;return o.forEach((([e,n])=>{(e<0||9<e||n<0||9<n||t[e][n].ship)&&(r=!1)})),r&&(e.push(i),o.forEach((([e,n],s)=>{t[e][n].ship=i,t[e][n].ship_index=s}))),r},receiveAttack:function([e,n]){const s=t[e][n];return s.ship?(s.ship.hit(s.ship_index),s.attacked="hit","hit"):(s.attacked="miss","miss")},getBoard:function(){return t.map((t=>t.map((t=>({...t})))))},allShipsSunk:function(){return e.every((t=>t.isSunk()))}}};function e(t){const e=[0,90,180,270],s=[0,1,2,3,4,5,6,7,8,9],c=n;[5,4,3,2,1].forEach((n=>{let a=!1;for(;!1===a;){const o=[c(s),c(s),c(e),n];a=t.placeShip(o)}}))}function n(t){return t[Math.floor(Math.random()*t.length)]}(function(){const n=function(){const t=document.getElementById("menu"),e=document.getElementById("menu-status"),n=document.getElementById("pvpBtn"),s=document.getElementById("pvcBtn"),c=document.getElementById("p1-gameboard"),a=document.getElementById("p2-gameboard"),o=document.getElementById("game-status");function i(t){t.innerHTML="";const e=[],n=document.createElement("div");n.className="grid",t.append(n);for(let t=0;t<10;t++){const s=document.createElement("div");s.className="row",e[t]=[],n.append(s);for(let n=0;n<10;n++){const c=document.createElement("div");c.className="cell",s.append(c),e[t][n]=c}}return e}function r(t,e,n){t.classList.contains(e)?(t.classList.remove(e),t.classList.add(n)):(t.classList.remove(n),t.classList.add(e))}function d(t){o.textContent=t}return{init:function(e,c){n.addEventListener("click",(()=>{r(t,"menu","hidden"),e()})),s.addEventListener("click",(()=>{r(t,"menu","hidden"),c()}))},render:function(t,e,n,s){const o=i(c),r=i(a);var u;u=o,t.forEach(((t,e)=>{t.forEach(((t,n)=>{t.ship?u[e][n].classList.add("ship"):u[e][n].classList.remove("ship"),"hit"===t.attacked?u[e][n].classList.add("hit"):"miss"===t.attacked&&u[e][n].classList.add("miss")}))})),function(t,e){t.forEach(((t,n)=>{t.forEach(((t,s)=>{"hit"===t.attacked?e[n][s].classList.add("hit"):"miss"===t.attacked&&e[n][s].classList.add("miss")}))}))}(e,r),function(t,e){t.forEach(((t,n)=>{t.forEach(((t,s)=>{t.addEventListener("click",(()=>e([n,s])))}))}))}(r,s),d(n)},clear:function(){c.innerHTML="",a.innerHTML=""},menu:function(n){e.innerHTML=`<h2>${n}</h2>`,r(t,"menu","hidden")},changePlayer:function(){const t=document.createElement("div");t.textContent="Attack missed the enemy ships, pass computer to your opponent and press any key to continue play.",t.classList.add("menu"),document.body.append(t),document.addEventListener("keydown",(function e(){document.body.removeChild(t),document.removeEventListener("keydown",e)}))},setGameStatus:d}}();function s(s){const c="pvp"===s,a=c?{gameBoard:function(){},attack:function(){},hasLost:function(){}}:function(){const t=[],e=[];for(let t=0;t<10;t++)for(let n=0;n<10;n++)e.push([t,n]);return{randomAttack:function(){const n=e.splice(Math.floor(Math.random()*e.length),1)[0];return t.push(n),n}}}(),o=t(),i=t();e(o),e(i);const r=[o,i];let d=Math.floor(2*Math.random());const u=()=>d,l=()=>0===d?1:0,m=()=>{d=l()};function h(t){const e=r[l()].receiveAttack(t);if(r[l()].allShipsSunk()){n.setGameStatus("");const t=(u()?"Second Player":"First Player")+" is victorious.";n.menu(t)}else"hit"===e?!c&&u()?h(a.randomAttack()):p():"miss"===e&&c?(n.changePlayer(),m(),p()):"miss"!==e||c||(m(),p(),u()?h(a.randomAttack()):p())}function p(){const t=(u()?"Second player's":"First player's")+" turn to attack.";n.render(r[u()].getBoard(),r[l()].getBoard(),t,!c&&u()?()=>{}:h)}u()&&!c&&h(a.randomAttack()),p()}n.init((()=>s("pvp")),(()=>s("pvc"))),n.menu("Select a Game Mode")})()})();